import{o as s,a as m,q,w as F}from"./chunk-NL6KNZEE-7k8Z-Yvn.js";import{B as C}from"./button-B8Hphn8C.js";import{X as A,P as b,F as l,C as H,S as O}from"./form.mapper-BINL6Sac.js";import{T as B}from"./checkbox-Dj_CrKob.js";import{p as K}from"./pkrf.service-BfYdIEl3.js";import{c as P,d as U}from"./token.encyption-CFrckQ9H.js";import{V as k}from"./index-Ce8uj8rm.js";import{C as $}from"./chevron-down-mo8rH555.js";import"./createLucideIcon-CHxtwjSd.js";import"./eye-off-BdLzCOdj.js";import"./index-BXveNCNt.js";import"./index-DoSk4ZnV.js";import"./index-CLxoSw2P.js";import"./Combination-CF10kduF.js";import"./index-DmjdnSH_.js";import"./api.client-ze5lrY9D.js";const _=({showModal:e,setShowModal:r,onConfirm:d})=>e?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"relative bg-white rounded-xl p-6 w-full max-w-sm shadow-lg text-center",children:[s.jsx("button",{onClick:()=>r(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",children:s.jsx(A,{className:"w-5 h-5"})}),s.jsx("div",{className:"flex items-center justify-center mb-4",children:s.jsx("div",{className:"bg-blue-100 text-blue-600 rounded-full p-2",children:s.jsx(B,{className:"w-6 h-6"})})}),s.jsx("h2",{className:"text-lg font-semibold mb-1",children:"Are you sure?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"This action can’t be undone. Please confirm if you want to proceed."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(C,{variant:"outline",className:"w-full",onClick:()=>r(!1),children:"Cancel"}),s.jsx(C,{className:"w-full bg-blue-500 hover:bg-blue-600",onClick:d,children:"Confirm"})]})]})}):null,z=({formData:e,setFormData:r})=>{var d,x,h,a,t,n,u,o,T,j,g,w,I,N,E;return s.jsxs("div",{className:"p-4 border border-gray-300 rounded bg-white shadow",children:[s.jsx("h3",{className:"text-2xl font-semibold mt-4  py-2 text-primary",children:"Review Your Information"}),s.jsx("p",{className:" mb-4 text-gray-500 text-sm italic",children:"Please carefully review all the details you have entered before proceeding. Make sure everything is correct to avoid any errors."}),s.jsx("h3",{className:"text-xl font-semibold my-4 border-b py-2  text-blue-800",children:"Personal Information"}),s.jsx(b,{label:"PhilHealth ID Number",value:(d=e.person)!=null&&d.philHealthIdNumber?(x=e.person)==null?void 0:x.philHealthIdNumber:"---",type:"text",className:{container:"border-b border-gray-100 py-2"}}),s.jsx(b,{label:"Full Name",value:(h=e.person)!=null&&h.firstName||(a=e.person)!=null&&a.lastName?`${e.person.firstName??""} ${e.person.middleName??""} ${e.person.lastName??""}${e.person.suffix&&e.person.suffix!=="N/A"?", "+e.person.suffix:""}`.replace(/\s+/g," ").trim():"---",type:"text",className:{container:"border-b border-gray-100 py-2 ",value:"uppercase"}}),s.jsx(b,{label:"Sex (Biological)",value:(t=e.person)!=null&&t.gender?(n=e.person)==null?void 0:n.gender:"---",type:"text",className:{container:"border-b border-gray-100 py-2",value:"uppercase"}}),s.jsx(b,{label:"Birthday",value:(u=e.person)!=null&&u.birthDate?(o=e.person)==null?void 0:o.birthDate:"---",type:"date",dateFormat:"mm/dd/yyyy",dateFormatType:"readable-1",className:{container:"border-b border-gray-100 py-2",value:"uppercase"}}),s.jsx(b,{label:"Current Address",value:[e.address[0].houseNo,e.address[0].street,e.address[0].barangay,e.address[0].city,e.address[0].province,"PHILIPPINES",e.address[0].zipCode].filter(Boolean).join(" ")||"---",type:"text",className:{container:"border-b border-gray-100 py-2",value:"uppercase"}}),s.jsx("h3",{className:"text-xl font-semibold my-4 border-b py-2  text-blue-800",children:"Account Information"}),s.jsx(b,{label:"Mobile Number",value:(T=e.account)!=null&&T.mobileNumber?(j=e.account)==null?void 0:j.mobileNumber:"---",type:"text",className:{container:"border-b border-gray-100 py-2"}}),s.jsx(b,{label:"Email",value:(g=e.account)!=null&&g.email?(w=e.account)==null?void 0:w.email:"---",type:"text",className:{container:"border-b border-gray-100 py-2",value:"uppercase"}}),s.jsx(b,{label:"MPIN",value:(I=e.account)!=null&&I.mpin?(N=e.account)==null?void 0:N.mpin:"---",type:"security",className:{container:"border-b border-gray-100 py-2"}}),s.jsxs("div",{className:"space-y-6 mt-4 bg-white p-6 rounded-xl shadow-md border",children:[s.jsx("div",{className:"space-y-3",children:s.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:"I hereby certify that I did not avail of FPE in other KPP. Moreover, I grant my free and voluntary consent to the collection, transmission and processing of my personal data and health records to PhilHelth for the purpose of paying and monitoring the provider for the Konsulta benefit in accordance with Republic Act No. 10173, otherwise known as the “Data Privacy Act of 2012”."})}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",id:"certify-checkbox",checked:(E=e.validation)==null?void 0:E.isCertifyTheData,onChange:f=>r(S=>({...S,validation:{...S.validation,isCertifyTheData:f.target.checked}})),className:"mt-1 accent-blue-600 w-4 h-4"}),s.jsx("label",{htmlFor:"certify-checkbox",className:"text-sm text-gray-800",children:"I confirm that the information provided is accurate and complete to the best of my knowledge. By checking this box and submitting, I agree to the Terms of Service and Privacy Policy, and acknowledge that this submission constitutes my electronic signature."})]})]})]})},M=({formData:e,setFormData:r,step:d})=>{var x,h,a;return s.jsxs(s.Fragment,{children:[d===1&&s.jsxs("div",{children:[s.jsx("div",{className:"w-full border-b border-gray-300 mb-2",children:s.jsx("h1",{className:"text-lg font-semibold bg-blue-800 text-white py-2 px-4 w-fit rounded-t-lg ",children:"Personal Information"})}),s.jsx(l,{title:"Client Type",description:"",placeholder:"Select Client Type",value:e.clientType||"",onChange:t=>r({...e,clientType:t}),options:[{value:"member",label:"Member"},{value:"dependent",label:"Dependent"}],required:!0,fieldType:"dropdown",inputTextCase:"uppercase"}),s.jsx(l,{title:"PhilHealth Number (Optional)",description:"",placeholder:"Enter PhilHealth Number",value:e.person.philHealthIdNumber||"",onChange:t=>r({...e,person:{...e.person,philHealthIdNumber:t}}),required:!1,fieldType:"philhealth-number",inputTextCase:"uppercase"}),s.jsx(l,{title:"Last Name",description:"",placeholder:"Enter Last Name",value:e.person.lastName||"",onChange:t=>r({...e,person:{...e.person,lastName:t}}),required:!0,fieldType:"name",inputTextCase:"uppercase"}),s.jsx(l,{title:"First Name",description:"",placeholder:"Enter First Name",value:e.person.firstName||"",onChange:t=>r({...e,person:{...e.person,firstName:t}}),required:!0,fieldType:"name",inputTextCase:"uppercase"}),s.jsx(l,{title:"Middle Name  (Optional)",description:"",placeholder:"Enter Middle Name",value:e.person.middleName||"",onChange:t=>r({...e,person:{...e.person,middleName:t}}),required:!1,fieldType:"name",inputTextCase:"uppercase"}),s.jsx(l,{title:"Extension Name  (Optional)",description:"",placeholder:"Enter Extension Name",value:e.person.suffix||"",onChange:t=>r({...e,person:{...e.person,suffix:t}}),otherValue:e.person.otherSuffix||"",onOtherChange:t=>r({...e,person:{...e.person,suffix:t}}),options:[{value:"N/A",label:"None"},{value:"Jr.",label:"Jr."},{value:"Sr.",label:"Sr."},{value:"II",label:"II"},{value:"III",label:"III"},{value:"IV",label:"IV"},{value:"V",label:"V"},{value:"VI",label:"VI"},{value:"VII",label:"VII"},{value:"VIII",label:"VIII"},{value:"IX",label:"IX"},{value:"X",label:"X"},{value:"other",label:"Other"}],required:!1,fieldType:"dropdown"}),s.jsx(l,{title:"Current Address",description:"",placeholder:"",value:((x=e.address)==null?void 0:x[0])||"",onChange:t=>r(n=>{const u=n.address.findIndex(o=>o.type===t.type);if(u!==-1){const o=[...n.address];return o[u]=t,{...n,address:o}}else return{...n,address:[...n.address,t]}}),required:!0,fieldType:"address-current",inputTextCase:"uppercase"}),s.jsx(l,{title:"Sex (Biological)",description:"",placeholder:"Select Sex (Biological)",value:e.person.gender||"",onChange:t=>r({...e,person:{...e.person,gender:t}}),options:[{value:"male",label:"Male"},{value:"female",label:"Female"}],required:!0,fieldType:"dropdown"}),s.jsx(l,{title:"Birthday",description:"",placeholder:"Enter Birthday",value:e.person.birthDate||"",onChange:t=>r({...e,person:{...e.person,birthDate:t}}),required:!0,fieldType:"birthDate",inputTextCase:"uppercase"})]}),d===2&&s.jsxs("div",{children:[s.jsx("div",{className:"w-full border-b border-gray-300 mb-2",children:s.jsx("h1",{className:"text-lg font-semibold bg-blue-800 text-white py-2 px-4 w-fit rounded-t-lg ",children:"Account Information"})}),s.jsx("div",{className:"w-full border-b border-gray-300 mb-2",children:s.jsx("h1",{className:"text-lg font-semibold bg-gray-400 text-white py-2 px-4 w-fit rounded-t-lg ",children:"Contact & Security"})}),s.jsx(l,{title:"Mobile Number",description:"",placeholder:"Enter Mobile Number",value:((h=e.account)==null?void 0:h.mobileNumber)||"",onChange:t=>r({...e,account:{...e.account,mobileNumber:t},validation:{...e.validation,isMobileNumberValid:t.length===12&&t.startsWith("639")}}),required:!0,fieldType:"phoneNumber",inputTextCase:"uppercase"}),s.jsx(l,{title:"Email (Optional)",description:"",placeholder:"Enter Email",value:((a=e.account)==null?void 0:a.email)||"",onChange:t=>{const n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t);r({...e,account:{...e.account,email:t},validation:{...e.validation,isEmailValid:n}})},required:!1,fieldType:"email",inputTextCase:"uppercase"}),s.jsx("div",{className:"w-full border-b border-gray-300 mb-2",children:s.jsx("h1",{className:"text-lg font-semibold bg-gray-400 text-white py-2 px-4 w-fit rounded-t-lg ",children:"Login Credentials"})}),s.jsx(l,{title:"Username",description:"",placeholder:"Enter Username",value:e.account.userName||"",onChange:t=>r({...e,account:{...e.account,userName:t}}),required:!0,fieldType:"short-text",inputTextCase:"uppercase"}),s.jsx(l,{title:"Enter 6-Digit MPIN (Mobile Personal Identification Number)",description:"",placeholder:"Enter 6-Digit MPIN",value:e.account.mpin||"",onChange:t=>r({...e,account:{...e.account,mpin:t}}),required:!0,fieldType:"mpin-6",inputTextCase:"uppercase"})]})]})},X=[{code:"en",label:"English"},{code:"tl",label:"Filipino (Tagalog)"}],v=(e,r)=>e[r.toUpperCase()],J=e=>({PKRF:{TITLE:v({EN:"PHilHealth Konsulta Registration Form",TL:"PHilHealth Konsulta Registration Form"},e),INSTRUCTION_KEY:v({EN:"Instructions",TL:"Panuto"},e),INSTRUCTION_VALUE:[v({EN:"1. All fields are mandatory.",TL:"1. Lahat ng bahagi ng form ay kailangang sagutan."},e),v({EN:"2. If the beneficiary is dependent, use the dependent PIN.",TL:"2. Kung ang benepisyaryo ay isang dependent, gamitin ang PIN ng dependent."},e),v({EN:"3.If the beneficiary is below 21 years old, the signatory should be the parent/guardian.",TL:"3.Kung ang benepisyaryo ay wala pang 21 taong gulang, ang pipirma ay dapat magulang o tagapangalaga."},e),v({EN:"4. Some fields already have default values, but you can choose the correct answer if you know it.",TL:"4. May default na sagot ang ilang field, pero maaari kang pumili ng tamang sagot kung alam mo."},e)]}}),V="pkrfFormData",Y={clientType:"member",kpp:"FTCC Health Clinic",person:{philHealthIdNumber:"",firstName:"",middleName:"",lastName:"",suffix:"",birthDate:"",age:void 0,mobileNumber:"",gender:""},address:[{houseNo:"",street:"",barangay:"",barangayCode:"",city:"",cityCode:"",province:"",provinceCode:"",zipCode:"",country:"Philippines",type:"current"}],account:{email:"",mobileNumber:"",mpin:""},validation:{isMobileNumberValid:!1,isEmailValid:!1,isCertifyTheData:!1}},G=()=>{if(typeof window<"u"){const e=localStorage.getItem(V);if(e)try{return JSON.parse(e)}catch(r){console.error("Failed to parse saved PKRF form data:",r)}}return Y},W=()=>{const[e,r]=m.useState(G);return m.useEffect(()=>{typeof window<"u"&&localStorage.setItem(V,JSON.stringify(e))},[e]),{formData:e,setFormData:r}};function Q(){const{formData:e,setFormData:r}=W(),[d,x]=m.useState("en"),h=J(d),[a,t]=m.useState(1),[n,u]=m.useState(!1),[o,T]=m.useState(!1),j=q(),[g,w]=m.useState(!1),I=async()=>{w(!0);try{const i={...e};if(await K.create(i)){k.success("Enrollment successful!");const p=await P(e.account,"pkrf",10*60*1e3);console.log("token",p);const y=await U(p,"pkrf");console.log("display",y),j(`/0/success?tkn=${p}&type=pkrf`)}}catch(i){const c={status:i.status||500,message:i.message||"Unknown error"},p=await P(c,"pkrf",10*60*1e3);j(`/0/failed?err=${encodeURIComponent(p)}&type=pkrf`),k.error("Something went wrong during submission.")}finally{w(!1)}},N=m.useRef(null);m.useEffect(()=>{setTimeout(()=>{N.current&&(N.current.scrollTop=0)},0)},[a]);const E=()=>{u(!1),I()},f=i=>{if(i===1)return!!(e.clientType&&e.person.gender);if(i===2){const{isEmailValid:c,isMobileNumberValid:p}=e.validation,y=e.account.email;return!!(p&&(!y||y&&c))}return i===3||i===4},S=()=>{var c,p,y;const i=[];return a===1&&(e.person.gender||i.push("Member Sex (Biological) is required."),e.clientType||i.push("Member Client Type is required."),(c=e.address[0])!=null&&c.barangay||i.push("Member Current Barangay is required."),(p=e.address[0])!=null&&p.city||i.push("Member Current City is required."),(y=e.address[0])!=null&&y.province||i.push("Member Current Province is required.")),a===2&&(e.account.email&&!e.validation.isEmailValid&&i.push("The email you entered is not valid."),e.validation.isMobileNumberValid||i.push("The mobile number is not valid.")),i.length===0?null:s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md mt-4",role:"alert",children:[s.jsx("div",{className:"font-bold mb-2",children:"Oops! Some required information is missing. Please complete the following:"}),s.jsx("ul",{className:"list-disc list-inside space-y-1",children:i.map((R,L)=>s.jsx("li",{children:R},L))})]})};return s.jsxs("div",{className:"relative max-w-4xl mx-auto w-full h-screen flex flex-col px-4 sm:px-6 lg:px-8",children:[s.jsx("div",{className:"sticky top-0 z-40 pt-4 pb-2 bg-white",children:s.jsxs("div",{className:"shadow-md border border-gray-100 mb-2 bg-white rounded-t-lg",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 border-b border-gray-200",children:[s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("img",{src:"/ftcc-logo2.png",alt:"FTCC Logo",className:"h-15"})}),s.jsx("div",{className:"flex items-center space-x-6",children:s.jsx("select",{className:"border border-gray-300 rounded-md p-1 text-sm",value:d,onChange:i=>x(i.target.value),"aria-label":"Select Language",children:X.map(({code:i,label:c})=>s.jsx("option",{value:i,children:c},i))})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:h.PKRF.TITLE}),s.jsxs("button",{className:"text-sm text-blue-600 hover:underline mt-1 flex items-center space-x-1",onClick:()=>T(!o),children:[s.jsx("span",{children:o?"Hide Instructions":"Show Instructions"}),o?s.jsx(H,{className:"w-4 h-4"}):s.jsx($,{className:"w-4 h-4"})]}),o&&s.jsx("div",{className:"mt-2 space-y-1",children:h.PKRF.INSTRUCTION_VALUE.map((i,c)=>s.jsx("p",{className:"text-sm text-gray-500 italic",children:i},c))})]}),s.jsx(O.Default,{step:a,steps:["Step 1","Step 2","Step 3"]})]})}),g?s.jsxs("div",{className:"flex flex-col items-center justify-center flex-grow space-y-4 py-10",children:[s.jsxs("svg",{className:"animate-spin h-10 w-10 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),s.jsx("p",{className:"text-gray-700 font-medium text-center",children:"Submitting your registration. Please wait..."})]}):s.jsx("div",{ref:N,style:{height:"auto",overflowY:"auto"},children:s.jsx("div",{className:"my-4 py-4 mb-20",children:s.jsxs("div",{className:"space-y-3",children:[a===1&&s.jsx(M,{formData:e,setFormData:r,step:1}),a===2&&s.jsx(M,{formData:e,setFormData:r,step:2}),a===3&&s.jsx(z,{formData:e,setFormData:r}),s.jsx("div",{children:!f(a)&&S()}),s.jsxs("div",{className:"flex sm:flex-row justify-center sm:justify-end mt-6 gap-3",children:[a>1&&s.jsx(C,{variant:"outline",className:"w-30 h-10",onClick:()=>t(a-1),disabled:g,children:"Back"}),a<3&&f(a)&&s.jsx(C,{className:"w-30 h-10 bg-blue-500 border text-white  hover:bg-blue-400",onClick:()=>f(a)&&t(a+1),disabled:!f(a)||g,children:"Next"}),a===3&&e.validation.isCertifyTheData&&s.jsx(C,{onClick:()=>u(!0),className:"w-30 h-10 bg-blue-500 border text-white  hover:bg-blue-400",disabled:g,children:"Submit"})]})]})})}),s.jsx(_,{showModal:n,setShowModal:u,onConfirm:E})]})}const he=()=>[{title:"FTCC | Registration "},{name:"description",content:"Electronic Medical Records system for FTCC."}],be=F(function(){return s.jsx("div",{className:"",children:s.jsx(Q,{})})});export{be as default,he as meta};
